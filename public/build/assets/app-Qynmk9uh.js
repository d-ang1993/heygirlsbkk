class H{constructor(){this.searchInput=document.querySelector(".navbar-search .search-input"),this.dropdown=document.getElementById("search-dropdown"),this.resultsList=document.getElementById("search-results-list"),this.viewAllLink=document.getElementById("view-all-results"),this.debounceTimer=null,this.isLoading=!1,this.init()}init(){this.searchInput&&(this.searchInput.addEventListener("input",e=>{this.handleInput(e)}),this.searchInput.addEventListener("focus",()=>{this.searchInput.value.length>=2&&this.showDropdown()}),this.searchInput.addEventListener("blur",e=>{setTimeout(()=>{this.dropdown.contains(document.activeElement)||this.hideDropdown()},200)}),document.addEventListener("click",e=>{e.target.closest(".navbar-search-container")||this.hideDropdown()}),this.searchInput.addEventListener("keydown",e=>{this.handleKeydown(e)}))}handleInput(e){const r=e.target.value.trim();this.debounceTimer&&clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout(()=>{r.length>=2?this.performSearch(r):this.hideDropdown()},300)}async performSearch(e){if(!this.isLoading){this.isLoading=!0,this.showLoading();try{const c=await(await fetch(`/wp-content/themes/heygirlsbkk/ajax-search.php?q=${encodeURIComponent(e)}`)).json();this.displayResults(c.results,e),this.viewAllLink.href=`/?s=${encodeURIComponent(e)}`}catch(r){console.error("Search error:",r),this.showError()}finally{this.isLoading=!1}}}displayResults(e,r){e.length===0?this.resultsList.innerHTML=`
                <div class="search-no-results">
                    <p>No results found for "${r}"</p>
                </div>
            `:(this.resultsList.innerHTML=e.map(c=>`
                <div class="search-result-item ${c.is_product?"search-result-product":""}" data-url="${c.url}">
                    ${c.thumbnail?`
                        <div class="search-result-image">
                            <img src="${c.thumbnail}" alt="${c.title}" loading="lazy" />
                        </div>
                    `:""}
                    <div class="search-result-content">
                        <div class="search-result-title">${this.highlightQuery(c.title,r)}</div>
                     
                    </div>
                </div>
            `).join(""),this.resultsList.querySelectorAll(".search-result-item").forEach(c=>{c.addEventListener("click",()=>{window.location.href=c.dataset.url})})),this.showDropdown()}highlightQuery(e,r){if(!r)return e;const c=new RegExp(`(${r})`,"gi");return e.replace(c,"<strong>$1</strong>")}showLoading(){this.resultsList.innerHTML=`
            <div class="search-loading">
                <div class="search-spinner"></div>
                <p>Searching...</p>
            </div>
        `,this.showDropdown()}showError(){this.resultsList.innerHTML=`
            <div class="search-error">
                <p>Search temporarily unavailable</p>
            </div>
        `,this.showDropdown()}showDropdown(){this.dropdown.style.display="block"}hideDropdown(){this.dropdown.style.display="none"}handleKeydown(e){const r=this.resultsList.querySelectorAll(".search-result-item");e.key==="ArrowDown"&&(e.preventDefault(),r.length>0&&r[0].focus())}}document.addEventListener("DOMContentLoaded",()=>{new H});document.addEventListener("DOMContentLoaded",function(){U(),document.addEventListener("added_to_cart",function(p){if(console.log("🎉 WooCommerce added_to_cart event triggered"),console.log("Event details:",p.detail),console.log("Event type:",p.type),console.log("Event target:",p.target),document.querySelectorAll(".add-to-cart-btn").forEach(r=>{r.disabled=!1,r.dataset.processing="false",r.innerHTML.includes("Adding...")&&(r.innerHTML="ADD TO CART")}),console.log("updateBagCount function available:",typeof updateBagCount=="function"),p.detail&&p.detail.fragments){console.log("Updating bag count using fragments...");const r=document.querySelector(".bag-count");if(r&&p.detail.fragments[".bag-count"]){const f=p.detail.fragments[".bag-count"].match(/>(\d+)</);f&&(r.textContent=f[1],console.log("✅ Updated bag count using fragments:",f[1]))}}typeof updateBagCount=="function"&&(console.log("Also calling updateBagCount as backup..."),setTimeout(()=>updateBagCount(),100))}),jQuery(document.body).on("wc_error",function(p,e){console.log("WooCommerce error:",e),document.querySelectorAll(".add-to-cart-btn").forEach(c=>{c.disabled=!1,c.dataset.processing="false",c.innerHTML.includes("Adding...")&&(c.innerHTML="ADD TO CART")})})});const M=document.createElement("style");M.textContent=`
    .cart-message {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 14px 22px;
      border-radius: 8px;
      font-size: 14px;
      color: white;
      font-weight: 600;
      z-index: 9999;
      box-shadow: 0 8px 25px rgba(0,0,0,0.15);
      display: none;
      animation: fadeSlide 0.3s ease-out;
    }
    .cart-message.success { background: linear-gradient(135deg, #10b981, #059669); }
    .cart-message.error { background: linear-gradient(135deg, #ef4444, #dc2626); }
    @keyframes fadeSlide {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .add-to-cart-btn .spinner {
      width: 16px; height: 16px;
      border: 2px solid #fff;
      border-top: 2px solid transparent;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      display: inline-block;
      vertical-align: middle;
      margin-right: 6px;
    }
    @keyframes spin { to { transform: rotate(360deg); } }
  `;document.head.appendChild(M);function U(){const p=document.querySelector(".cart-trigger"),e=document.getElementById("cart-drawer"),r=document.querySelector(".cart-drawer-close"),c=document.querySelector(".cart-drawer-overlay");if(!p||!e)return;function f(){return window.innerWidth<=768}p.addEventListener("click",function(d){if(d.preventDefault(),f()){const y=this.getAttribute("data-cart-url");y&&(window.location.href=y);return}u()}),r&&r.addEventListener("click",g),c&&c.addEventListener("click",g),document.addEventListener("keydown",function(d){d.key==="Escape"&&e.classList.contains("active")&&g()});function u(d=!1){console.log("🛒 Opening cart drawer...",d?"(force refresh)":""),e.classList.add("active"),document.body.style.overflow="hidden",A(d)}function g(){e.classList.remove("active"),document.body.style.overflow=""}let a=null,w=0;const O=3e4;function A(d=!1){var S,E;const y=document.querySelector(".cart-loading"),v=document.querySelector(".cart-content"),i=document.querySelector(".cart-drawer-footer"),l=Date.now();if(!d&&a&&l-w<O){console.log("Using cached cart data"),x(a);return}y.style.display="flex",v.style.display="none",i.style.display="none";const h=((S=window.wc_cart_params)==null?void 0:S.ajax_url)||"/wp-admin/admin-ajax.php";fetch(h,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"action=woocommerce_get_cart_contents&nonce="+(((E=window.wc_cart_params)==null?void 0:E.nonce)||"")}).then(t=>{if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return t.json()}).then(t=>{var o,n,s,C,L;console.log("=== CART DRAWER OPENED - BAG DATA ==="),console.log("Full cart response:",t),t.success?(console.log("✅ Cart data loaded successfully"),console.log("📦 Cart items:",((o=t.data)==null?void 0:o.items)||[]),console.log("💰 Cart total:",((n=t.data)==null?void 0:n.total)||"N/A"),console.log("📊 Cart subtotal:",((s=t.data)==null?void 0:s.subtotal)||"N/A"),console.log("🔢 Item count:",((C=t.data)==null?void 0:C.count)||0),(L=t.data)!=null&&L.items&&t.data.items.length>0?(console.log("=== CART ITEMS DETAILS ==="),t.data.items.forEach((b,m)=>{console.log(`Item ${m+1}:`,{name:b.name,quantity:b.quantity,price:b.price,variation:b.variation,cart_item_key:b.cart_item_key})})):console.log("🛒 Cart is empty"),a=t.data,w=l,x(t.data)):(console.error("Cart data error:",t),I())}).catch(t=>{console.error("Error loading cart:",t),I()})}function x(d){const y=document.querySelector(".cart-loading"),v=document.querySelector(".cart-content"),i=document.querySelector(".cart-drawer-footer"),l=document.querySelector(".cart-items"),h=document.querySelector(".cart-empty");if(y.style.display="none",v.style.display="block",i.style.display="none",d&&d.items&&d.items.length>0){l.style.display="block",h.style.display="none",i.style.display="block",l.innerHTML=d.items.map(t=>`
                <div class="cart-item" data-cart-item-key="${t.cart_item_key}">
                    <div class="cart-item-image">
                        <img src="${t.image}" alt="${t.name}" loading="lazy">
                    </div>
                    <div class="cart-item-details">
                        <div class="cart-item-name">${t.name}</div>
                        ${t.variation?`<div class="cart-item-variation">${t.variation}</div>`:""}
                        <div class="cart-item-price">${t.price}</div>
                        <div class="cart-item-quantity">
                            <button class="quantity-btn minus" data-cart-item-key="${t.cart_item_key}">-</button>
                            <input type="number" class="quantity-input" value="${t.quantity}" min="1" data-cart-item-key="${t.cart_item_key}">
                            <button class="quantity-btn plus" data-cart-item-key="${t.cart_item_key}">+</button>
                        </div>
                        <button class="cart-item-remove" data-cart-item-key="${t.cart_item_key}">Remove</button>
                    </div>
                </div>
            `).join("");const S=document.querySelector(".cart-subtotal-amount"),E=document.querySelector(".cart-total-amount");S&&d.subtotal&&(S.textContent=d.subtotal),E&&d.total&&(E.textContent=d.total),j()}else l.style.display="none",h.style.display="block",i.style.display="none"}function j(){var d,y,v;document.querySelectorAll(".quantity-btn").forEach(i=>{i.addEventListener("click",function(){const l=this.getAttribute("data-cart-item-key"),h=this.classList.contains("plus"),S=document.querySelector(`input[data-cart-item-key="${l}"]`);let E=parseInt(S.value);h?E++:E=Math.max(1,E-1),T(l,E)})}),document.querySelectorAll(".quantity-input").forEach(i=>{i.addEventListener("change",function(){const l=this.getAttribute("data-cart-item-key"),h=Math.max(1,parseInt(this.value)||1);T(l,h)})}),document.querySelectorAll(".cart-item-remove").forEach(i=>{i.addEventListener("click",function(){const l=this.getAttribute("data-cart-item-key");q(l)})}),(d=document.querySelector(".continue-shopping"))==null||d.addEventListener("click",function(){g()}),(y=document.querySelector(".view-cart-btn"))==null||y.addEventListener("click",function(i){i.preventDefault();const l=document.querySelector(".cart-trigger").getAttribute("data-cart-url");window.location.href=l}),(v=document.querySelector(".checkout-btn"))==null||v.addEventListener("click",function(i){i.preventDefault(),window.location.href="/checkout/"})}function T(d,y){var i,l;const v=((i=window.wc_cart_params)==null?void 0:i.ajax_url)||"/wp-admin/admin-ajax.php";fetch(v,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`action=woocommerce_update_cart_item&cart_item_key=${d}&quantity=${y}&nonce=${((l=window.wc_cart_params)==null?void 0:l.nonce)||""}`}).then(h=>h.json()).then(h=>{h.success&&(a=null,A(!0),$())}).catch(h=>{console.error("Error updating cart item:",h)})}function q(d){var v,i;const y=((v=window.wc_cart_params)==null?void 0:v.ajax_url)||"/wp-admin/admin-ajax.php";fetch(y,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`action=woocommerce_remove_cart_item&cart_item_key=${d}&nonce=${((i=window.wc_cart_params)==null?void 0:i.nonce)||""}`}).then(l=>l.json()).then(l=>{l.success&&(a=null,A(!0),$())}).catch(l=>{console.error("Error removing cart item:",l)})}function $(){var y,v;console.log("🔄 updateBagCount function called");const d=((y=window.wc_cart_params)==null?void 0:y.ajax_url)||"/wp-admin/admin-ajax.php";fetch(d,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`action=woocommerce_get_cart_count&nonce=${((v=window.wc_cart_params)==null?void 0:v.nonce)||""}`}).then(i=>i.json()).then(i=>{if(console.log("📊 Bag count response:",i),i.success){const l=document.querySelector(".bag-count");if(l){const h=l.textContent;l.textContent=i.data,console.log(`✅ Bag count updated: ${h} → ${i.data}`)}else console.warn("⚠️ .bag-count element not found")}else console.error("❌ Bag count update failed:",i)}).catch(i=>{console.error("❌ Error updating bag count:",i)})}function I(){const d=document.querySelector(".cart-loading"),y=document.querySelector(".cart-content"),v=document.querySelector(".cart-drawer-footer"),i=document.querySelector(".cart-items"),l=document.querySelector(".cart-empty");d.style.display="none",y.style.display="block",v.style.display="none",i.style.display="none",l.style.display="none",y.innerHTML='<div class="cart-error"><p>Error loading cart. Please try again.</p></div>'}window.openCartDrawer=u,window.closeCartDrawer=g,window.updateBagCount=$,window.loadCartContent=A}document.addEventListener("DOMContentLoaded",function(){const p=document.querySelector(".custom-add-cart-form");p&&p.addEventListener("submit",function(t){t.preventDefault(),t.stopPropagation(),console.log("Custom cart form submission prevented, using AJAX instead")}),document.addEventListener("submit",function(t){(t.target.classList.contains("cart")||t.target.classList.contains("variations_form")||t.target.classList.contains("custom-add-cart-form"))&&(console.log("=== FORM SUBMISSION DETECTED ==="),console.log("Form class:",t.target.className),console.log("Form action:",t.target.action),console.log("Event target:",t.target))});const e=document.querySelector(".add-to-cart-btn");document.querySelector(".quantity-input");const r=document.querySelector(".quantity-btn.minus"),c=document.querySelector(".quantity-btn.plus"),f=document.getElementById("product-price-display"),u=document.getElementById("stock-status-display");console.log("Add to cart button found:",e);let g={},a=null;const w=window.productVariations||[];console.log("Available variations:",w),w.length>0&&(console.log("First variation structure:",w[0]),console.log("First variation keys:",Object.keys(w[0]))),document.addEventListener("click",function(t){if(t.target.classList.contains("color-dot")){console.log("Color dot clicked:",t.target);const o=t.target;if(o.classList.contains("out-of-stock"))return;document.querySelectorAll(".color-dot").forEach(n=>n.classList.remove("selected")),o.classList.add("selected"),g.color=o.getAttribute("data-color"),console.log("Color selected:",g.color),I(),i()}if(t.target.classList.contains("size-button")){console.log("Size button clicked:",t.target);const o=t.target;if(o.classList.contains("out-of-stock"))return;document.querySelectorAll(".size-button").forEach(n=>n.classList.remove("selected")),o.classList.add("selected"),g.size=o.getAttribute("data-size"),console.log("Size selected:",g.size),I(),i()}});const O=document.querySelector(".clear-selection");O&&O.addEventListener("click",function(t){t.preventDefault(),sizeButtons.forEach(o=>o.classList.remove("selected")),selectedSize=null,a=null,d(),i()});const A=document.querySelector(".quantity-value"),x=document.querySelector(".spinner-btn.up"),j=document.querySelector(".spinner-btn.down");function T(t){A&&(A.textContent=t)}function q(){return A&&parseInt(A.textContent)||1}r&&r.addEventListener("click",function(){const t=q();t>1&&T(t-1)}),c&&c.addEventListener("click",function(){const t=q(),o=a?a.stock_quantity:999;t<o&&T(t+1)}),x&&x.addEventListener("click",function(){const t=q(),o=a?a.stock_quantity:999;t<o&&T(t+1)}),j&&j.addEventListener("click",function(){const t=q();t>1&&T(t-1)});function $(t){const o=`.${t}-button, .${t}-dot`,n=document.querySelectorAll(o);n.length&&n.forEach(s=>{const C=s.getAttribute(`data-${t}`),L=w.find(b=>{const m={...g,[t]:C};return Object.entries(m).every(([D,_])=>b[D]===_)});console.log(L),L&&L.in_stock?(s.classList.remove("out-of-stock"),s.disabled=!1,s.style&&(s.style.opacity="1",s.style.cursor="pointer")):(s.classList.add("out-of-stock"),s.disabled=!0,s.style&&(s.style.opacity="0.5",s.style.cursor="not-allowed"))})}function I(){if(w.length===0)return;y().forEach(o=>{$(o)})}function d(){if(w.length===0)return;y().forEach(o=>{const n=`.${o}-button, .${o}-dot`;document.querySelectorAll(n).forEach(s=>{s.classList.remove("out-of-stock"),s.disabled=!1,s.style&&(s.style.opacity="1",s.style.cursor="pointer")})})}function y(){if(w.length===0)return[];const t=new Set;w.forEach(s=>{Object.keys(s).forEach(C=>t.add(C))});const o=["id","price","regular_price","sale_price","image","price_html","in_stock","stock_quantity","variation_id","price_html"],n=Array.from(t).filter(s=>{if(o.includes(s))return!1;const C=w.map(b=>b[s]).filter(b=>b!=null&&b!=="");return[...new Set(C)].length>1});return console.log("Detected selectable attributes:",n),n}function v(){if(w.length===0)return console.log("No variations found"),!1;const t=y();console.log("Required attributes:",t),console.log("Selected attributes:",g);const o=t.every(n=>g[n]);return console.log("Has all required attributes:",o),o}function i(){console.log("updateProductDisplay called");const t=v();if(console.log("Has required attributes:",t),t)if(a=w.find(o=>Object.entries(g).every(([n,s])=>o[n]===s)),console.log("Selected variation:",a),console.log("Selected attributes:",g),a){console.log("Price data:",{price:a.price,price_html:a.price_html,regular_price:a.regular_price,sale_price:a.sale_price});const o=a.price||a.price_html||"Price not available";f.innerHTML=o,u.innerHTML=a.in_stock?'<span class="stock-status in-stock">IN STOCK</span>':'<span class="stock-status out-of-stock">OUT OF STOCK</span>',e&&(e.disabled=!a.in_stock,e.textContent=a.in_stock?"ADD TO CART":"OUT OF STOCK",e.onclick=null,a.in_stock&&!e.dataset.handlerAdded&&(e.onclick=s=>{s.preventDefault(),s.stopPropagation(),l(s)},e.dataset.handlerAdded="true"),console.log("Button disabled:",e.disabled,"Stock:",a.in_stock)),console.log("About to update wishlist button with variation:",a.variation_id),console.log("Full selectedVariation object:",a),console.log("Available properties:",Object.keys(a));const n=a.variation_id||a.id||a.variationId;console.log("Extracted variation ID:",n),S(n)}else f.innerHTML='<div class="price-current">Combination not available</div>',u.innerHTML='<span class="stock-status out-of-stock">NOT AVAILABLE</span>',e&&(e.disabled=!0,e.textContent="Combination Not Available",e.onclick=null);else{const o=w.length>0?w[0].price:"Price not available";f.innerHTML=o,u.innerHTML='<span class="stock-status">Select options to see availability</span>',e&&(e.disabled=!0,e.textContent="Select Options",e.onclick=null)}}function l(t){var b;if(t&&(t.preventDefault(),t.stopImmediatePropagation()),window.addToCartProcessing){console.log("⚠️ Add to cart already processing, ignoring duplicate call");return}if(window.addToCartProcessing=!0,console.log("=== CUSTOM ADD TO CART CALLED ==="),console.log("selectedVariation:",a),console.log("selectedAttributes:",g),!a){h("Please select all required options","error"),window.addToCartProcessing=!1;return}const o=q(),n=new FormData,s=((b=window.item)==null?void 0:b.product_id)||(a==null?void 0:a.product_id)||(a==null?void 0:a.id);n.append("product_id",s),n.append("add-to-cart",s),n.append("variation_id",a.id),n.append("quantity",o);const C={...a.attributes,...g};console.log("All attributes:",C),Object.entries(C).forEach(([m,D])=>{if(!D)return;let _;m.startsWith("attribute_")?_=m:m.startsWith("pa_")?_=`attribute_${m}`:_=`attribute_pa_${m.replace(/^pa_/,"")}`;const k=D.toString().trim().toLowerCase().replace(/\s+/g,"-");n.append(_,k),n.append(`variation[${_}]`,k),console.log(`Added attribute: ${_} = ${k}`)});let L="/?wc-ajax=add_to_cart";typeof wc_add_to_cart_params<"u"&&wc_add_to_cart_params.wc_ajax_url?L=wc_add_to_cart_params.wc_ajax_url.replace("%%endpoint%%","add_to_cart"):typeof window.productAddToCartUrl<"u"?L=window.productAddToCartUrl:(n.append("action","woocommerce_add_to_cart"),L="/wp-admin/admin-ajax.php"),console.log("🧾 AJAX URL:",L),console.log("📦 Form Data:",Object.fromEntries([...n.entries()])),fetch(L,{method:"POST",body:n,credentials:"same-origin"}).then(m=>{if(!m.ok)throw new Error(`HTTP ${m.status}`);return m.text()}).then(m=>{try{return JSON.parse(m)}catch{return console.warn("Non-JSON response — treating as success"),{success:!0}}}).then(m=>{if(console.log("📦 WooCommerce Response:",m),m.success===!1){h("Error: "+(m.data||"Unknown error"),"error"),window.addToCartProcessing=!1;return}m.fragments&&Object.entries(m.fragments).forEach(([k,P])=>{const B=document.querySelector(k);B&&(B.innerHTML=P)});const D=new CustomEvent("added_to_cart",{detail:{fragments:m.fragments,cart_hash:m.cart_hash,button:document.querySelector(".add-to-cart-btn")}});document.body.dispatchEvent(D),typeof jQuery<"u"&&jQuery(document.body).trigger("added_to_cart",[m.fragments,m.cart_hash,jQuery(".add-to-cart-btn")]);const _=document.querySelector(".add-to-cart-btn");if(_){const k=_.innerHTML;_.innerHTML="✅ Added!",_.style.background="#10b981",setTimeout(()=>{_.innerHTML=k,_.style.background=""},2e3)}setTimeout(()=>{if(typeof window.openCartDrawer=="function")window.openCartDrawer(!0);else{const k=document.querySelector(".cart-trigger, .navbar-bag, [data-cart-url]");k&&k.click()}typeof window.loadCartContent=="function"&&setTimeout(()=>window.loadCartContent(!0),100),typeof window.updateBagCount=="function"&&setTimeout(()=>window.updateBagCount(),200),window.addToCartProcessing=!1},500)}).catch(m=>{console.error("❌ Add to cart error:",m),h("❌ Error adding product to cart","error"),window.addToCartProcessing=!1})}function h(t,o){let n=document.querySelector(".cart-message");n||(n=document.createElement("div"),n.className="cart-message",document.body.appendChild(n)),n.textContent=t,n.className=`cart-message ${o}`,n.style.display="block",setTimeout(()=>{n.style.display="none"},3e3)}function S(t){console.log("updateWishlistButton called with variation ID:",t);const o=document.querySelector(".tinvwl_add_to_wishlist_button, [data-tinv-wl-list], .tinv-wl-button, .tinvwl-button");console.log("Wishlist button found:",o),o&&t?(o.classList.remove("disabled"),o.setAttribute("data-variation-id",t),o.setAttribute("data-tinv-wl-productvariation",t),o.style.opacity="1",o.style.pointerEvents="auto",console.log("Wishlist button enabled for variation:",t),console.log("Wishlist button attributes:",{"data-variation-id":o.getAttribute("data-variation-id"),"data-tinv-wl-productvariation":o.getAttribute("data-tinv-wl-productvariation"),class:o.className,opacity:o.style.opacity})):(console.log("Wishlist button not found or no variation ID"),console.log("Available buttons:",document.querySelectorAll("button, a").length),console.log("All button classes:",Array.from(document.querySelectorAll("button, a")).map(n=>n.className)))}function E(){const t=document.querySelector(".tinvwl_add_to_wishlist_button");t&&(t.classList.add("disabled"),t.setAttribute("data-variation-id","0"),t.style.opacity="0.5",t.style.pointerEvents="none",t.addEventListener("click",function(o){const n=this.getAttribute("data-variation-id");if(!n||n==="0")return o.preventDefault(),o.stopPropagation(),alert("Please select product options first."),!1}),console.log("Wishlist button initialized and disabled"))}i(),setTimeout(E,500)});document.addEventListener("DOMContentLoaded",function(){console.log("TI Wishlist integration starting..."),setTimeout(function(){var p=document.querySelector("form.variations_form, form[data-product_variations], .variations_form"),e=document.querySelector(".tinvwl_add_to_wishlist_button, [data-tinv-wl-list], .tinv-wl-button, .tinvwl-button, .tinvwl_add_to_wishlist");console.log("Form found:",p?1:0),console.log("Wishlist button found:",e?1:0),console.log("Wishlist button HTML:",e);var r=e&&e.getAttribute("data-tinv-wl-producttype")==="variable";if(console.log("Is variable product:",r),(r||p)&&e)console.log("Setting up wishlist for variable product"),e.classList.add("disabled"),e.setAttribute("data-variation-id",0),e.style.opacity="0.5",e.style.pointerEvents="none",p&&p.addEventListener("found_variation",function(f){console.log("WooCommerce variation found:",f.detail);var u=f.detail;u&&u.variation_id&&(e.classList.remove("disabled"),e.setAttribute("data-variation-id",u.variation_id),e.setAttribute("data-tinv-wl-productvariation",u.variation_id),e.style.opacity="1",e.style.pointerEvents="auto",console.log("Wishlist button enabled for variation:",u.variation_id))}),document.addEventListener("click",function(f){(f.target.classList.contains("color-dot")&&f.target.classList.contains("selected")||f.target.classList.contains("size-button")&&f.target.classList.contains("selected"))&&(console.log("Custom variation selection detected"),setTimeout(function(){var u=window.selectedVariation;u&&u.variation_id&&(console.log("Custom variation found:",u),e.classList.remove("disabled"),e.setAttribute("data-variation-id",u.variation_id),e.setAttribute("data-tinv-wl-productvariation",u.variation_id),e.style.opacity="1",e.style.pointerEvents="auto",console.log("Wishlist button enabled for custom variation:",u.variation_id))},100))}),e.addEventListener("click",function(f){var u=this.getAttribute("data-variation-id");if(console.log("Wishlist clicked, variation ID:",u),!u||u==0)return f.preventDefault(),f.stopPropagation(),alert("Please select product options first."),!1});else if(e)console.log("Simple product - wishlist enabled immediately");else{var c=document.querySelectorAll("button, a");console.log("No wishlist button found. Available buttons:",c.length),console.log("All buttons:",Array.from(c).map(function(f){return f.className}))}},1e3)});function W(){const p=document.querySelector(".navbar-shop"),e=document.querySelector(".navbar-dropdown");if(!p||!e)return;let r=!1,c=null;function f(){clearTimeout(c),e.style.display="block",e.classList.add("active"),p.classList.add("active"),r=!0}function u(){clearTimeout(c),c=setTimeout(()=>{e.style.display="none",e.classList.remove("active"),p.classList.remove("active"),r=!1},200)}p.addEventListener("click",function(g){g.preventDefault(),g.stopPropagation(),r?u():f()}),p.addEventListener("mouseenter",function(){f()}),e.addEventListener("mouseenter",function(){f()}),p.addEventListener("mouseleave",function(){u()}),e.addEventListener("mouseleave",function(){u()}),document.addEventListener("click",function(g){!p.contains(g.target)&&!e.contains(g.target)&&u()}),document.addEventListener("keydown",function(g){g.key==="Escape"&&r&&u()})}document.addEventListener("DOMContentLoaded",function(){setTimeout(W,100)});
